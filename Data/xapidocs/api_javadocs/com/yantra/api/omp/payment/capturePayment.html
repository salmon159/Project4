<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0) on Wed Sep 28 16:02:42 UTC 2022 -->
<title>capturePayment (IBM Sterling Dev java docs)</title>
<meta name="date" content="2022-09-28">
<link rel="stylesheet" type="text/css" href="../../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="capturePayment (IBM Sterling Dev java docs)";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":6};
var tabs = {65535:["t0","All Methods"],2:["t2","Instance Methods"],4:["t3","Abstract Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div role="navigation" title ="TOP_Navigation" aria-label ="Top Navigation Bar"/>
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>IBM Sterling Selling And Fulfillment Foundation 10.0</b></div>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../com/yantra/api/omp/payment/computeRefundPayments.html" title="interface in com.yantra.api.omp.payment"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/yantra/api/omp/payment/capturePayment.html" target="_top">Frames</a></li>
<li><a href="capturePayment.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div role="main" title ="capturePayment" aria-labelledby ="Header1"/>
<div class="header">
<div class="subTitle">com.yantra.api.omp.payment</div>
<h2 title="Interface capturePayment" class="title" id="Header1">Interface capturePayment</h2>
</div>
<div class="contentContainer">
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Known Subinterfaces:</dt>
<dd>com.yantra.api.OMPApi, <a href="../../../../../com/yantra/interop/japi/YIFApi.html" title="interface in com.yantra.interop.japi">YIFApi</a></dd>
</dl>
<hr>
<br>
<pre>public interface <span class="typeNameLabel">capturePayment</span></pre>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t3" class="tableTab"><span><a href="javascript:show(4);">Abstract Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>org.w3c.dom.Document</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../../../com/yantra/api/omp/payment/capturePayment.html#capturePayment-com.yantra.yfs.japi.YFSEnvironment-org.w3c.dom.Document-">capturePayment</a></span>(<a href="../../../../../com/yantra/yfs/japi/YFSEnvironment.html" title="interface in com.yantra.yfs.japi">YFSEnvironment</a>&nbsp;env,
              org.w3c.dom.Document&nbsp;inXML)</code>
<div class="block">
 The <code>capturePayment</code> API is used to intelligently add payment methods to an order, accepting the bare minimum of input to achieve the desired
 results depending upon the type of payment method information passed.</div>
</td>
</tr>
</table>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="capturePayment-com.yantra.yfs.japi.YFSEnvironment-org.w3c.dom.Document-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>capturePayment</h4>
<pre>org.w3c.dom.Document&nbsp;capturePayment(<a href="../../../../../com/yantra/yfs/japi/YFSEnvironment.html" title="interface in com.yantra.yfs.japi">YFSEnvironment</a>&nbsp;env,
                                    org.w3c.dom.Document&nbsp;inXML)
                             throws com.yantra.yfs.japi.YFSException,
                                    java.rmi.RemoteException</pre>
<div class="block"><p>
 The <code>capturePayment</code> API is used to intelligently add payment methods to an order, accepting the bare minimum of input to achieve the desired
 results depending upon the type of payment method information passed. In particular, the <code>ChargeSequence</code> and the <code>MaxChargeLimit</code>
 will typically be computed if not passed; some <code>PaymentMethod</code>s will not even process these in the input.
 </p>


 <p>
 This API will divide <code>PaymentMethod</code>s into the following groups:
 </p>
 <ul>
 <li>No payment processing required</li>
 <li>Charge up to available</li>
 <li>Other payments with a limited amount</li>
 <li>A payment method designed to cover the remainder of the order total</li>
 </ul>

 <p>
 <b>No processing payment methods</b>
 </p>
 <p>
 These payment methods are payment methods that are identified by the <code>NoProcessingRequired</code> configuration, and are typically payments like
 cash. When the <code>RequestAmount</code> is passed for these payment methods, there will be a CHARGE ChargeTransactionDetail created, similar to the
 API. <code>recordExternalCharges</code>; this parameter is required for this type.<br>
 <code>MaxChargeLimit</code> - is set based on the RequestedAmount attribute passed in the input. If the Payment Method is created or <code>IsCorrection</code>
 flag is passed as Y, then the RequestedAmount is set as the <code>MaxChargeLimit</code>. If Payment Method is modified and <code>IsCorrection</code> flag is not
 passed as Y, then MaxChargeLimit will be incremented by the amount passed in the input(RequestedAmount).<br>
 <code>Charge Sequence</code> - will begin at 100 and increment with each one added, if not passed.
 </p>
 <p>
 <b>Charge up to available</b>
 </p>
 <p>
 These payment methods are payment methods that are identified by the <code>ChargeUpToAvailable</code> configuration, and are typically payments like gift
 cards, where there is a balance that can be queried. <code>YFSGetFundsAvailabeUE</code> will be called to get the Funds Available for this
 type of <code>PaymentMethod</code>.<br>
 <code>MaxChargeLimit</code> - if <code>RequestedAmount</code> is passed, then the minimum of (RequestedAmount, Funds Available, RemainingAmountToAuth from Order)
 will be used. If <code>RequestedAmount</code> is not passed, then minimum of (Funds Available, RemainingAmountToAuth from Order) will be used.<br>
 <code>Charge Sequence</code> - if not passed, will be inserted in the ascending order of amount, starting at 5000. This will decrement if the next payment
 is less than the previous, and when inserted between two existing payments, the <code>ChargeSequence</code> will be the difference between the two.
 For example -<br>
                        <dd>- Add Payment Method P1 with amount 50, Charge Sequence will be set to 5000.</dd>
                        <dd>- Add Payment Method P2 with amount 75, Charge Sequence will be set to 5100.</dd>
                        <dd>- Add Payment Method P3 with amount 60, Charge Sequence will be set to 5050. Notice that Charge Sequence got adjusted in between the previous
                                payments.</dd>
                        <dd>- Add Payment Method P4 with amount 40, Charge Sequence will be set to 4900. Charge Sequence got adjusted to a value less than the previous lowest
                                payment.</dd>
 </p>
 <p>
 <b>Other payments with a limited amount</b>
 </p>
 <p>
 These payment methods are payment methods that are not identified by either configuration above, and the <code>RequestAmount</code> is passed, which will
 be set as the <code>MaxChargeLimit</code>. <code>ChargeSequence</code> is incremented from 50000, if not passed.
 </p>
 <p>
 <b>Remainder payment methods</b>
 </p>
 <p>
 These payment methods are payment methods that are not identified by either configuration above, and the <code>RequestAmount</code> is not passed.
 <code>ChargeSequence</code> is decremented from 99900, if not passed. This <code>PaymentMethod</code> will have its <code>MaxChargeLimit</code> set to
 the value of the <code>RemainingAmountToAuth</code> attribute from getOrderDetails. Only the highest sequenced payment method will have the
 <code>MaxChargeLimit</code> set, others added to this group will be set to zero.<br>
 <b>NOTE</b>: After every add/modify/delete operation performed on any Payment Method, this API resets the <code>MaxChargeLimit</code> of the
 highest sequenced Payment Method belonging to this group. It will be updated as the <code>RemainingAmountToAuth</code> from Order.
 </p>
 <BR>
 <p>
 <b>Reshuffling</b> - When charge up to available payments are added such that the difference between their <code>ChargeSequence</code>s is less than 10,
 or if one type of payment exceeds the range provided and crosses over another type of payment, the <code>PaymentMethod</code>s are reshuffled. This will
 reset the <code>ChargeSequence</code> of each payment method, and will redistribute them according to the defaults. Any payment that shares the same
 <code>ChargeSequence</code> as another payment may have its <code>ChargeSequence</code> altered, but both will have the same new sequence.
 <code>ChargeSequence</code> is not set in correlation to the <code>PaymentType</code> <code>ChargeSequence</code> configuration, but when processing the
 order the sequence in the configuration still takes priority.  An offset of a multiple of 2000 will be added to a <code>PaymentMethod</code> in order to
 ensure a separation of <code>PaymentMethod</code> if the typical starting sequence would overlap with the previous group.
 </p>
 <p>
 <b>Zero Amount Authorization</b>: If the Payment Type of the Payment Method added is configured to perform zero amount authorization, then a zero
 amount authorization is acquired on the Payment Method provided one of the following is true -<br>
                        <dd>- Payment Rule on the Order supports Delayed Authorization.</dd>
                        <dd>- Payment Rule on the Order supports Charge Transaction Requests for Authorization and Charge Transaction Requests are not created for the
                                total Order amount.</dd>
 Zero Amount Authorization is attempted only when a Payment Method is added. If the authorization fails, the API throws exception with appropriate error
 codes and the Payment changes are rolled back. However the exception can be ignored and the Payment Method can still be added by passing the flag
 <code>ProceedOnZeroAmountFailure</code> as Y.
 </p>
 <BR>
 <p>
 <b>Charge Transaction Requests</b> - When the Payment Rule on the Order requires Charge Transaction Requests for Authorization:<br>
 If there are insufficient Charge Transaction Requests created for the Order, then no payments are required. In such scenarios <code>capturePayment</code> can add
 <code>PaymentMethods</code> but <code>MaxChargeLimit</code> will only be set to the Charge Transaction Request total for all the Payment Methods (payment methods of type No payment
 processing required may exceed this, as they are pre-processed).
 </p>
 <p>
 The API can be rerun after Charge Transaction Requests are created, with the Payment Methods for which <code>MaxChargeLimit</code> is set to zero.
 However for Payment Methods of type Other payments the attribute <code>RequestedAmount</code> should be passed to set <code>MaxChargeLimit</code>.
 If amount is not passed then <code>MaxChargeLimit</code> will remain zero. For Payment types in the Charge Up To available and Remainder groups,
 <code>MaxChargeLimit</code> will be determined by the API.
 </p>
 <BR>
 <p>
 <b>Collect</b> - When the Operation is passed as <code>Collect</code>, the Collection user exit, specific to the <code>PaymentTypeGroup</code>, will be
 invoked, and the <code>RequestedAmount</code> (after adjusting for considerations such as order total and funds available) will be collected. This will
 also mark any collected amount as collected In Person, which will be used to track card present transactions from backend processing.
 </p>
 <BR>
 <p>
 <b>Return Orders</b> - For Return Orders, this API can only be used to create, modify and delete Payment Methods on them. No more additional payment
 processing is done for Return Orders. The attribute <code>RequestedAmount</code> is set as <code>PlannedRefundAmount</code> for the Payment Method.
 Refer to <code>computeReturnPayments</code> API javadocs for more information about <code>PlannedRefundAmount</code>.
 </p>
 <BR>
 <B> Business Validation</B>
 <p> Business Validation framework is invoked when normal business rules needs  be overridden for the order to proceed. 
 <ul>
 <li>If the current transaction meets any such business condition, then the override framework is invoked to evaluate the 
 override rules setup for the following validations: </li>
 </ul>
 <p>
 <!--- TABLE START --->
 <a name="xmltable"></a>
 <table BORDER="1" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">         
        <tr>
                <td COLSPAN=5 BGCOLOR="#EEEEFF"><font-family="Arial","Helvetica,san-serif" ><b>Related Information <b></font></td>
        <tr>
                <td>TENDER_LIMIT</td>
                <td>This validation is invoked whenever a valid payment method is added to an order or removed from an order or suspended/unsuspended. It defines the total amount of payment methods that can be placed on an order by <code>PaymentType</code> and <code>PaymentCardType</code>.</td>
                <td>ErrorCode: NONE </td>
                <td><a href="../../../../../XSD/HTML/OMP_Validation_TenderLimit.html">Validation Input XML  </td>
                <td><a href="../../../../../dtd/OMP_Validation_TenderLimit_dtd.txt">Validation DTD</td>
        
        </tr>
        <tr>
                <td>OFFLINE_LIMIT</td>
                <td>This validation is invoked when contact with the payment gateway cannot be established for an IN_PERSON call. It defines the maximum total by <code>PaymentType</code> and <code>PaymentCardType</code> an order should be allowed to be accepted as paid by the system if payment processing is offline.</td>
                <td>ErrorCode: NONE </td>
                <td><a href="../../../../../XSD/HTML/OMP_Validation_OfflineLimit.html">Validation Input XML  </td>
                <td><a href="../../../../../dtd/OMP_Validation_OfflineLimit_dtd.txt">Validation DTD</td>
        
        </tr>
        <tr>
                <td>CALL_FOR_AUTHORIZATION</td>
                <td>This validation is invoked when capturePayment in called with CallForAuthorization operation. It validates that a manager has confirmed the called authorization code was entered properly.</td>
                <td>ErrorCode: NONE </td>
                <td><a href="../../../../../XSD/HTML/OMP_Validation_CallForAuthorization.html">Validation Input XML  </td>
                <td><a href="../../../../../dtd/OMP_Validation_CallForAuthorization_dtd.txt">Validation DTD</td>
        
        </tr>
 </table>
 <p>
 <p>
 <!--- TABLE START ---> <a name="xmltable"></a>
 <table BORDER="1" WIDTH="100%" CELLPADDING="1" CELLSPACING="0">
 <tr>
 <td COLSPAN=6 BGCOLOR="#EEEEFF"><font-family="Arial","Helvetica,san-serif" ><b>Related Documents<b></font></td>
 <tr>
 <td><a href="../../../../../XSD/HTML/OMP_capturePayment_input.html"> Input XML</a></td>
 <td><a href="../../../../../dtd/OMP_capturePayment_input_dtd.txt">Input DTD </a></td>
 <td><a href="../../../../../XSD/HTML/OMP_capturePayment_output.html">Output XML</td>
 <td><a href="../../../../../dtd/OMP_capturePayment_output_dtd.txt">Output DTD</td>
 <td><a href="../../../../../XSD/HTML/YFSError.html">Error XML</a></td>
 <td><a href="../../../../../dtd/YFSError_dtd.txt">Error DTD</a></td>
 </tr>
 </table>
 <!-- TABLE END --> <br>
 <B>User Exits:</B>
 <ul>For each Payment Method belonging to the group <b>Charge up to available payments</b>, the following user exit is invoked. It queries the funds
 available on the Payment Method.<br/>
 <ul><a href="../../../yfs/japi/ue/YFSGetFundsAvailableUE.html">com.yantra.yfs.japi.ue.YFSGetFundsAvailableUE</a><br/>
 </ul></ul>
 <br/>
 <ul>If a Payment Method requires Zero Amount Authorization or the Collect operation, the API invokes one or more of the following user exits -<br/>
 <ul>
 <a href="../../../yfs/japi/ue/YFSCollectionCreditCardUE.html">com.yantra.
 yfs.japi.ue.YFSCollectionCreditCardUE</a><br>
 <a href="../../../yfs/japi/ue/YFSCollectionCustomerAccountUE.html">com.
 yantra.yfs.japi.ue.YFSCollectionCustomerAccountUE</a><br>
 <a href="../../../yfs/japi/ue/YFSCollectionOthersUE.html">com.yantra.yfs.
 japi.ue.YFSCollectionOthersUE</a><br>
 <a href="../../../yfs/japi/ue/YFSCollectionStoredValueCardUE.html">com.
 yantra.yfs.japi.ue.YFSCollectionStoredValueCardUE</a><br>
 <a href="../../../yfs/japi/ue/YFSCollectionDebitCardUE.html">com.yantra.
 yfs.japi.ue.YFSCollectionDebitCardUE</a><br>
 </ul>
 <br/>
 <ul>
 If the UserExit corresponding to the <code>PaymentType</code> of the Payment Method is not found, the following error is thrown. <br>
 <i>YFS10497</i> - <i>UserExit not found.</i> <br>
 </ul>
 </ul>
 <br/>
 <B>Events Raised:</B> None

 <br>
 <B>Audits:</B> No. <br>
 <br>
 <B>Pre-conditions:</B> <br>
 This API assumes the order is already available in the system. <br>
 <br>
 <B>Post-conditions:</B> <br>
 None <br>
 <br>
 <B>Output Template Support:</B> Yes. <br>
 <br>
 <B>Database Extensibility Support:</B> No. <br>
<br></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>env</code> - Environment handle returned by the <code>createEnvironment</code> API. This is a mandatory parameter.</dd>
<dd><code>inXML</code> - Required. For more information, see the associated <a href="#xmltable">input xml files</a>. <br>
<br></dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>An XML document that contains details of the charges on the order and it's suborders. For details on the output, refer to the associated <a
         href="#xmltable">output xml files</a>. <br>
 <br></dd>
<dt><span class="throwsLabel">Throws:</span></dt>
<dd><code><b>YFSException</b></code> - Exception containing error codes in the standard <a href="#xmltable">error files</a>. <br></dd>
<dd><code><b>RemoteException</b></code> - Java's default remote exception handler. <br>
<br>
<br></dd>
<dd><code>com.yantra.yfs.japi.YFSException</code></dd>
<dd><code>java.rmi.RemoteException</code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div role="navigation" title ="Bottom_NAVIGATION" aria-label ="Bottom Navigation Bar"/>
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../../index-all.html">Index</a></li>
<li><a href="../../../../../help-doc.html">Help</a></li>
</ul>
<div class="aboutLanguage"><b>IBM Corp. Confidential</b></div>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev&nbsp;Class</li>
<li><a href="../../../../../com/yantra/api/omp/payment/computeRefundPayments.html" title="interface in com.yantra.api.omp.payment"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../../index.html?com/yantra/api/omp/payment/capturePayment.html" target="_top">Frames</a></li>
<li><a href="capturePayment.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
<div role="contentinfo" title ="contentinfo_title" aria-label ="Contains footer note"/>
<p class="legalCopy"><small><font face='Verdana' size='1'>&#169; Copyright IBM Corp. 2001, 2013 All Rights Reserved. </font></small></p>
</body>
</html>
